# ‚úÖ K6 Load Test Report: Complete Booking Workflow Test (Successful Run)

## üìÑ Test Scenario Overview

| Attribute | Detail |
| :--- | :--- |
| **Test Script** | `03-booking-workflow.js` (End-to-End Test) |
| **Test Purpose** | To validate the **entire user booking pipeline**‚ÄîLock $\rightarrow$ Preview $\rightarrow$ Confirm‚Äîunder controlled, ramping load. |
| **Critical Flow** | Multi-step user journey, testing the **transactional integrity** and latency of the entire booking system. |
| **Target Load** | Ramping up to a **peak of 25 Virtual Users (VUs)**. |
| **Initial Seats** | 100 available seats. |
| **Showtime ID** | `31c32904-7863-43f2-af97-c9adc9261962` |

---

## ‚öôÔ∏è Load Profile (Setup Scenario)

The test used a **Ramping VUs** executor, peaking at 25 VUs, designed to simulate a medium load with contention for the limited seats.

| Stage | Duration | Target Virtual Users (VUs) | Goal |
| :--- | :--- | :--- | :--- |
| **Ramp Up** | 50s | 20 | Increase load to normal level. |
| **Peak Load** | 40s | **25** | Stress transactional endpoints. |
| **Ramp Down** | 50s | 0 | Monitor cool-down. |

---

## üö¶ Threshold Assessment Summary

The test **PASSED ALL THRESHOLDS**. The system successfully executed the complete booking workflow with a low error rate and excellent per-step latency, demonstrating robust transactional integrity under load.

| Metric | Threshold | Actual Result | Status | Key Insight |
| :--- | :--- | :--- | :--- | :--- |
| **`http_req_failed`** | Rate $< 30\%$ | **$0.27\%$** | ‚úÖ **PASS** | Near-zero rate of unexpected errors (5xx/timeouts), indicating high stability. |
| **`booking_success_rate`** | Rate $> 5\%$ | $12.64\%$ | ‚úÖ **PASS** | Achieved a sufficient number of completed transactions despite high contention. |
| **`total_booking_duration` p(95)** | $< 8000$ ms | $5295.15$ ms | ‚úÖ **PASS** | Total end-to-end time is well within acceptable limits. |
| **`step_lock_duration` p(95)** | $< 2000$ ms | $226.8$ ms | ‚úÖ **PASS** | All step latencies are fast (sub-second). |

---

## üìä Detailed Metric Analysis

### 1. Business Success Metrics (Functional Validation)

The goal was to see if the full transaction pipeline could complete under contention.

| Metric | Result | Meaning of Result | Code Line/Logic |
| :--- | :--- | :--- | :--- |
| **`booking_started`** | **530** | Total attempts to start the flow. | Line 206: `bookingStarted.add(1);` |
| **`booking_completed`** | **67** | Total number of **successful end-to-end transactions** (reaching `PENDING_PAYMENT` status). | Line 310: `bookingCompleted.add(1);` |
| **`booking_conflict`** | **463** | The number of times the flow was gracefully aborted because seats were already taken (expected behavior). | Line 275: `bookingConflict.add(1);` (Includes seats being gone at Step 1, Line 248, or conflict at the lock request, Line 275). |
| **`booking_success_rate`** | **$12.64\%$** | **PASS.** This is a healthy completion rate, considering the high contention for only 100 seats across 530 total attempts. | Lines 311, 276. |
| **`checks_succeeded`** | **$100.00\%$** | All integrity checks passed. Every successful booking transaction was correctly formed and reached the required `PENDING_PAYMENT` status. | Lines 303-306. |

### 2. Stability and Error Metrics

The stability of the system is excellent under this load profile.

| Metric | Result | Insight | Code Line/Logic |
| :--- | :--- | :--- | :--- |
| **`http_req_failed`** | **$0.27\%$ (2 failures)** | **EXCELLENT STABILITY.** This near-zero rate (only 2 unexpected HTTP failures out of 737 requests) confirms the system is not crashing or timing out under load. When a user couldn't book, they received a graceful conflict (`409`/`423`) rather than a system error (`5xx`). | Tracks failures outside of expected 2xx/409/423 responses. |

### 3. Step-by-Step Latency Analysis

The individual steps are fast, although the end-to-end P95 is higher due to VUs competing and waiting for fresh seat data (Lines 228-243). 

| Step Name | Endpoint | Actual p(95) | Target p(95) | Insight |
| :--- | :--- | :--- | :--- | :--- |
| **Step 1: Lock Seats** | `/seat-locks` (POST) | $226.8$ ms | $< 2000$ ms | Very fast. The time includes fetching the fresh list of available seats for the current iteration, which adds overhead. |
| **Step 2: Price Preview**| `/bookings/price-preview`| $56.2$ ms | $< 1000$ ms | Extremely fast. Light-weight calculation. |
| **Step 3: Confirm Booking**| `/bookings/confirm` | $129$ ms | $< 3000$ ms | **Fast Transaction.** This is the most critical and complex step (writes to DB, finalizes the lock, transitions state), and its latency is excellent. |
| **Total Duration** | End-to-End | $5295.15$ ms | $< 8000$ ms | Acceptable end-to-end time. The high P95 is mostly driven by the simulated **think time** added between steps (`sleep` calls) and the time spent re-fetching available seats when a conflict occurs. |

---

## üöÄ Overall Test Conclusion

The **Complete Booking Workflow Test PASSED** decisively.

The system is validated as **stable, reliable, and performant** for the end-to-end booking journey up to a load of 25 concurrent users. The architecture correctly handles concurrency by forcing graceful conflicts rather than failing with internal errors.

### Recommended Next Steps

1.  **Increase Stress:** Since the system showed near-perfect stability at 25 VUs, run the test again at a higher peak target (e.g., $50 \rightarrow 75$ VUs) to determine the system's actual **scalability limit** for complex transactional workflows.
2.  **Payment Integration:** If the payment gateway is critical, run a subsequent test that integrates the **actual external payment call (Step 4)** to measure the total user experience time and external dependency latency.